<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>NyaX New User</title>
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script src="https://cdn.jsdelivr.net/npm/@twemoji/api@latest/dist/twemoji.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/emojione@4.0.0/lib/js/emojione.min.js"></script>
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap');
            :root {
                /* 共通色設定 */
                --primary-color: #1d9bf0;
                --primary-hover-color: #1a8cd8;
                --like-color: #f91880;
                --star-color: #ffad1f;
                /* ライトモード(デフォルト)色設定 */
                --border-color: #eff3f4;
                --bg-color: #f9f9f9;
                --main-bg-color: white;
                --ad-bg-color: #f7f9f9;
                --pg-bg-color: rgba(255, 255, 255, 0.85); /* ページヘッダーなど */
                --emoji-bg-color: none;
                --notification-bg-color: #e8f5fd;
                --text-color: #0f1419;
                --secondary-text-color: #536471;
                --logo-color: black; /* ロゴ表示用に使っているが背景色と真逆の色を使う時に指定されることもある */
                --loading-color: rgba(255, 255, 255, 0.7);
                --widget-bg-color: #e7e8e8; /* プロフィールカードホバー時 */
                --emoji-mart: 255, 255, 255;
                --bw: #000000;
                --spin: rgba(0, 0, 0, 0.1);
                --light-primary-color: #cce6ff;
                --danger-color: #fef0f4;
            }
            
            body {
                font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
                margin: 0;
                background-color: var(--main-bg-color);
                color: var(--text-color);
            }
            
            /* 入力欄のフォントをNoto Sans JPに統一 */
            input, textarea {
                font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            }
            
            /* Emoji Oneの画像設定 */
            img.emojione{
                width: 1.1rem;
                height: auto;
            }
            
            /* Twemojiの画像設定 */
            img.emoji{
                display: inline-block;
                width: 1.1rem;
                height: auto;
                padding-right: 1px;
            }
            .sidebar-widget {
                background-color: var(--bg-color);
                border-radius: 16px;
                margin-bottom: 1rem;
                overflow: hidden;
            }
            
            .widget-title {
                font-size: 1.25rem;
                font-weight: 800;
                padding: 0.75rem 1rem;
            }
            
            /* ▼▼▼ このブロックを修正 ▼▼▼ */
            .widget-item {
                padding: 0.75rem 1rem;
                cursor: pointer;
                transition: background-color 0.2s;
            }
            
            .widget-item:hover {
                background-color: var(--widget-bg-color);
            }
            
            .recommend-user {
                display: flex;
                justify-content: space-between;
                align-items: center;
                gap: 0.8rem; /* 要素間の隙間を追加 */
            }
            
            /* ▼▼▼ このブロックを新規追加 ▼▼▼ */
            /* ユーザー情報を含むリンク（aタグ）の挙動を定義 */
            .recommend-user > a {
                min-width: 0; /* flexアイテムが自身のコンテンツ幅以下に縮むことを許可 */
                flex-shrink: 1; /* 親コンテナが狭いときに縮むことを許可 */
                overflow: hidden; /* はみ出し防止のため */
            }
            
            /* ユーザー名とIDを囲むdiv */
            .recommend-user > a > div {
                overflow: hidden; /* 中のspanがはみ出た場合に隠すため */
            }
            
            /* フォローボタンは縮まないようにする */
            .recommend-user > button {
                flex-shrink: 0;
            }
            /* ▲▲▲ 追加ここまで ▲▲▲ */
            /* プロフィール画面の参加日のスタイル */
            .profile-joined {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                color: var(--secondary-text-color);
                font-size: 0.95rem;
                margin-top: 0.6rem;
            }
            
            .calendar-icon {
                width: 1rem;
                height: 1rem;
                flex-shrink: 0;
                stroke-width: 1.8;
            }
        </style>
    </head>
    <body>
        <input type="text" id="limit">
        <button type="button" id="submit">取得</button>
        <br>
        <span id="user_list"></span>
        <span id="error"></span>
        <script>
            window.addEventListener('DOMContentLoaded', async () => {
                const SUPABASE_URL = 'https://mnvdpvsivqqbzbtjtpws.supabase.co';
                const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1udmRwdnNpdnFxYnpidGp0cHdzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyNTM0MTIsImV4cCI6MjA2ODgyOTQxMn0.v5tAGcd0K4VW9yR1CZYVjMYHLhWJXN7Tz5j9DNf1CQE';
                const { createClient } = window.supabase;
                const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                const limit_input = document.querySelector('input#limit');
                const submit_button = document.querySelector('button#submit');
                const user_span = document.querySelector('span#user_list');
                const error_span = document.querySelector('span#error');
                
                function escapeHTML(str) {
                    if (typeof str !== 'string') return '';
                    const div = document.createElement('div');
                    div.textContent = str;
                    return div.innerHTML;
                }
                function getEmoji(str) {
                    return emojione.toImage(str);
                }
                const calender_icon = `<svg class="calendar-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true" focusable="false"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>`;
                submit_button.addEventListener('click', async () => {
                    error_span.textContent = '';
                    const userId = Number(limit_input.value);
                    const { data: user, error } = await supabase.from('user').select('*').eq('id', userId).single();
                    user_span.textContent = JSON.stringify(user);
                    error_span.textContent = error;
                });
            });
        </script>
    </body>
</html>
